# 小遥搜索项目 (XiaoyaoSearch) - Project Context

## Purpose
小遥搜索是一个跨平台的本地文件智能搜索工具，通过AI多模态理解能力，为个人用户提供文本、语音、图片、视频等多种文件的语义化检索服务，提升个人知识管理效率。

### 核心目标
- **快速原型开发**: 优先实现MVP核心功能
- **隐私保护**: 主要使用本地AI模型，确保用户数据隐私
- **跨平台支持**: 支持Windows、Mac、Linux三大桌面平台
- **智能语义搜索**: 理解用户查询意图，而非简单的关键词匹配
- **多模态文件支持**: 支持文档、图片、音频、视频等多种文件类型

### 目标用户
- 需要管理大量本地文件(1万以内)的个人用户
- 知识工作者、内容创作者、研究人员等
- 注重数据隐私和专业性的用户群体

## Tech Stack

### 前端技术栈
- **Electron 27.0+**: 跨平台桌面应用框架
- **React 18.2+**: UI框架
- **TypeScript 5.2+**: 类型安全
- **Ant Design 5.11+**: UI组件库
- **Zustand 4.4+**: 轻量级状态管理
- **React Query 5.8+**: 数据请求管理

### 后端技术栈
- **Python 3.10+**: 后端开发语言
- **FastAPI 0.104+**: 高性能Web框架
- **Uvicorn 0.24+**: ASGI服务器

### AI技术栈
- **PyTorch 2.1+**: 深度学习框架
- **Transformers 4.35+**: HuggingFace模型库
- **FlagEmbedding 1.2+**: BGE Embedding模型
- **Whisper 20231117**: 语音识别模型
- **CN-CLIP 1.5+**: 中文视觉理解模型

### 检索与存储
- **Faiss 1.7.4**: 向量检索引擎
- **Whoosh 2.7.4**: 全文检索引擎
- **SQLite 3.x**: 嵌入式关系数据库

### 文件处理
- **Marker 0.2+**: PDF转Markdown
- **PaddleOCR 2.7+**: 中文OCR
- **FFmpeg 4.x+**: 音视频处理
- **watchdog 3.0+**: 文件系统监控

## Project Conventions

### Code Style
- **TypeScript严格模式**: 启用所有严格类型检查
- **ESLint + Prettier**: 统一代码格式化
- **中文注释**: 核心业务逻辑使用中文注释说明
- **函数命名**: 动词开头，驼峰命名法 (handleSearch, processFile)
- **组件命名**: PascalCase (SearchBar, ResultList)
- **常量命名**: UPPER_SNAKE_CASE (MAX_FILE_SIZE, DEFAULT_PAGE_SIZE)

### Architecture Patterns
- **分层架构**: 客户端层 → 后端服务层 → AI服务层 → 数据存储层
- **模块化设计**: 按功能模块组织代码，保持低耦合高内聚
- **依赖注入**: 使用FastAPI的依赖注入系统
- **异步处理**: 文件处理和AI推理使用异步编程
- **事件驱动**: 文件监控和状态更新使用事件机制
- **策略模式**: AI服务支持本地/云端策略切换

### Testing Strategy
- **单元测试**: 核心业务逻辑覆盖率 > 80%
- **集成测试**: API接口和数据库操作测试
- **端到端测试**: 关键用户流程自动化测试
- **性能测试**: 搜索响应时间和索引构建性能测试
- **测试框架**: pytest (Python), Jest + Testing Library (TypeScript)

### Git Workflow
- **主分支**: main - 稳定发布版本
- **开发分支**: develop - 开发集成分支
- **功能分支**: feature/* - 新功能开发
- **修复分支**: hotfix/* - 紧急修复
- **提交信息**: 使用中文，格式为 "模块: 简短描述"
- **代码审查**: 所有代码变更需要Code Review

## Domain Context

### 文件搜索领域知识
- **语义搜索**: 理解查询意图，处理同义词、近义词关系
- **多模态检索**: 文本、图像、音频的统一向量表示
- **相关性算法**: BM25、余弦相似度、RRF融合算法
- **中文处理**: 分词、语义理解、OCR识别

### AI模型应用
- **BGE模型**: 中文文本向量化，768维向量表示
- **Whisper**: 语音转文字，支持多语言识别
- **Chinese-CLIP**: 中文图像理解，图文匹配
- **LLM应用**: 查询理解、关键词提取、摘要生成

### 个人知识管理
- **文件组织**: 目录结构、标签分类、元数据管理
- **检索效率**: 快速响应、准确匹配、智能排序
- **用户体验**: 简洁界面、快捷操作、实时反馈

## Important Constraints

### 性能约束
- **搜索响应时间**: < 1秒 (本地文件 < 1万)
- **索引构建速度**: > 100文件/分钟
- **内存使用**: < 2GB (包含AI模型加载)
- **启动时间**: < 10秒 (应用冷启动)

### 资源约束
- **文件数量限制**: 支持1万以内文件
- **单文件大小限制**: 文档100MB，图片50MB，音视频1GB
- **存储空间**: 索引大小 < 原文件大小的20%
- **CPU使用**: 后台索引时 < 50% CPU占用

### 隐私约束
- **本地优先**: 核心功能在本地运行，不依赖网络
- **数据不上传**: 用户文件和数据不离开本地设备
- **加密存储**: 敏感数据本地加密存储
- **用户控制**: 用户完全控制数据访问和删除

### 兼容性约束
- **操作系统**: Windows 10+, macOS 10.15+, Ubuntu 18.04+
- **Python版本**: 3.10+ (后端要求)
- **Node.js版本**: 18+ (前端构建要求)
- **硬件要求**: 8GB+ RAM推荐，SSD存储推荐

## External Dependencies

### AI模型依赖
- **BGE-base-zh-v1.5**: 中文文本嵌入模型，本地部署
- **Whisper-medium**: 语音识别模型，本地部署
- **Chinese-CLIP**: 中文图文理解模型，本地部署
- **Ollama**: 本地LLM服务，可选集成
- **OpenAI API**: 云端LLM服务，可选集成

### 系统工具依赖
- **FFmpeg**: 音视频处理，系统预装或打包分发
- **LibreOffice**: Office文档转换，系统预装
- **Python包管理**: pip, conda环境管理
- **Node.js生态**: npm/yarn包管理，Vite构建工具

### 第三方服务
- **GitHub Releases**: 应用自动更新服务
- **镜像源**: 模型下载加速（可选）
- **CDN服务**: 静态资源分发（可选）
